23/07/30 01:49:16 WARN Utils: Your hostname, DESKTOP-7CJ4JJ1 resolves to a loopback address: 127.0.1.1; using 172.20.232.170 instead (on interface eth0)
23/07/30 01:49:16 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
23/07/30 01:49:17 INFO SparkContext: Running Spark version 3.3.1
23/07/30 01:49:17 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
23/07/30 01:49:17 INFO ResourceUtils: ==============================================================
23/07/30 01:49:17 INFO ResourceUtils: No custom resources configured for spark.driver.
23/07/30 01:49:17 INFO ResourceUtils: ==============================================================
23/07/30 01:49:17 INFO SparkContext: Submitted application: Python Spark SQL basic example
23/07/30 01:49:17 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
23/07/30 01:49:17 INFO ResourceProfile: Limiting resource is cpu
23/07/30 01:49:17 INFO ResourceProfileManager: Added ResourceProfile id: 0
23/07/30 01:49:17 INFO SecurityManager: Changing view acls to: mattnhb
23/07/30 01:49:17 INFO SecurityManager: Changing modify acls to: mattnhb
23/07/30 01:49:17 INFO SecurityManager: Changing view acls groups to: 
23/07/30 01:49:17 INFO SecurityManager: Changing modify acls groups to: 
23/07/30 01:49:17 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(mattnhb); groups with view permissions: Set(); users  with modify permissions: Set(mattnhb); groups with modify permissions: Set()
23/07/30 01:49:17 INFO Utils: Successfully started service 'sparkDriver' on port 41993.
23/07/30 01:49:17 INFO SparkEnv: Registering MapOutputTracker
23/07/30 01:49:17 INFO SparkEnv: Registering BlockManagerMaster
23/07/30 01:49:17 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
23/07/30 01:49:17 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
23/07/30 01:49:17 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
23/07/30 01:49:18 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-92a70692-ede0-4872-b364-9dd5431732c8
23/07/30 01:49:18 INFO MemoryStore: MemoryStore started with capacity 2004.6 MiB
23/07/30 01:49:18 INFO SparkEnv: Registering OutputCommitCoordinator
23/07/30 01:49:18 INFO Utils: Successfully started service 'SparkUI' on port 4040.
23/07/30 01:49:18 INFO Executor: Starting executor ID driver on host 172.20.232.170
23/07/30 01:49:18 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
23/07/30 01:49:18 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 34743.
23/07/30 01:49:18 INFO NettyBlockTransferService: Server created on 172.20.232.170:34743
23/07/30 01:49:18 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
23/07/30 01:49:18 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 172.20.232.170, 34743, None)
23/07/30 01:49:18 INFO BlockManagerMasterEndpoint: Registering block manager 172.20.232.170:34743 with 2004.6 MiB RAM, BlockManagerId(driver, 172.20.232.170, 34743, None)
23/07/30 01:49:18 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 172.20.232.170, 34743, None)
23/07/30 01:49:18 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 172.20.232.170, 34743, None)
23/07/30 01:49:18 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
23/07/30 01:49:18 INFO SharedState: Warehouse path is 'file:/home/mattnhb/Clonadinhos/feature_store/spark-warehouse'.
23/07/30 01:49:19 INFO InMemoryFileIndex: It took 18 ms to list leaf files for 1 paths.
23/07/30 01:49:19 INFO SparkContext: Starting job: load at NativeMethodAccessorImpl.java:0
23/07/30 01:49:19 INFO DAGScheduler: Got job 0 (load at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/07/30 01:49:19 INFO DAGScheduler: Final stage: ResultStage 0 (load at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:19 INFO DAGScheduler: Parents of final stage: List()
23/07/30 01:49:19 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:19 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[1] at load at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:19 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 102.9 KiB, free 2004.5 MiB)
23/07/30 01:49:19 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 37.1 KiB, free 2004.5 MiB)
23/07/30 01:49:19 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.20.232.170:34743 (size: 37.1 KiB, free: 2004.6 MiB)
23/07/30 01:49:19 INFO SparkContext: Created broadcast 0 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:19 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[1] at load at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/07/30 01:49:19 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
23/07/30 01:49:19 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (172.20.232.170, executor driver, partition 0, PROCESS_LOCAL, 4715 bytes) taskResourceAssignments Map()
23/07/30 01:49:19 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
23/07/30 01:49:19 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 237618 bytes result sent to driver
23/07/30 01:49:19 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 473 ms on 172.20.232.170 (executor driver) (1/1)
23/07/30 01:49:19 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
23/07/30 01:49:19 INFO DAGScheduler: ResultStage 0 (load at NativeMethodAccessorImpl.java:0) finished in 0.565 s
23/07/30 01:49:19 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
23/07/30 01:49:19 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
23/07/30 01:49:19 INFO DAGScheduler: Job 0 finished: load at NativeMethodAccessorImpl.java:0, took 0.589025 s
23/07/30 01:49:20 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.20.232.170:34743 in memory (size: 37.1 KiB, free: 2004.6 MiB)
23/07/30 01:49:21 WARN package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
23/07/30 01:49:22 INFO DataSourceStrategy: Pruning directories with: isnotnull(data_processamento#3),(data_processamento#3 = 2023-07-30)
23/07/30 01:49:22 INFO FileSourceStrategy: Pushed Filters: 
23/07/30 01:49:22 INFO FileSourceStrategy: Post-Scan Filters: 
23/07/30 01:49:22 INFO FileSourceStrategy: Output Data Schema: struct<cod_chav_patc: string, cod_orde_tran: string, metricas: struct<contactless_sem_autentificacao: struct<ultimos_180_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_270_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_30_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_365_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_7_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field> ... 1 more field>, debito_com_autenticacao: struct<ultimos_180_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_270_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_30_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_365_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_7_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field> ... 1 more field>, debito_sem_autenticacao: struct<ultimos_180_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_270_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_30_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_365_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_7_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field> ... 1 more field>, geral: struct<ultimos_180_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_270_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_30_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_365_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_7_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field> ... 1 more field> ... 2 more fields> ... 1 more fields>
23/07/30 01:49:22 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 1807.7 KiB, free 2002.8 MiB)
23/07/30 01:49:22 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 63.4 KiB, free 2002.8 MiB)
23/07/30 01:49:22 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.20.232.170:34743 (size: 63.4 KiB, free: 2004.5 MiB)
23/07/30 01:49:22 INFO SparkContext: Created broadcast 1 from javaToPython at NativeMethodAccessorImpl.java:0
23/07/30 01:49:22 INFO InMemoryFileIndex: Selected 1 partitions out of 2, pruned 50.0% partitions.
23/07/30 01:49:22 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/07/30 01:49:22 INFO DAGScheduler: Registering RDD 6 (javaToPython at NativeMethodAccessorImpl.java:0) as input to shuffle 0
23/07/30 01:49:22 INFO DAGScheduler: Got map stage job 1 (javaToPython at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/07/30 01:49:22 INFO DAGScheduler: Final stage: ShuffleMapStage 1 (javaToPython at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:22 INFO DAGScheduler: Parents of final stage: List()
23/07/30 01:49:22 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:22 INFO DAGScheduler: Submitting ShuffleMapStage 1 (MapPartitionsRDD[6] at javaToPython at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:22 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 249.2 KiB, free 2002.5 MiB)
23/07/30 01:49:22 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 16.1 KiB, free 2002.5 MiB)
23/07/30 01:49:22 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 172.20.232.170:34743 (size: 16.1 KiB, free: 2004.5 MiB)
23/07/30 01:49:22 INFO SparkContext: Created broadcast 2 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:22 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[6] at javaToPython at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/07/30 01:49:22 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
23/07/30 01:49:22 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (172.20.232.170, executor driver, partition 0, PROCESS_LOCAL, 5039 bytes) taskResourceAssignments Map()
23/07/30 01:49:22 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (172.20.232.170, executor driver, partition 1, PROCESS_LOCAL, 5039 bytes) taskResourceAssignments Map()
23/07/30 01:49:22 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
23/07/30 01:49:22 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
23/07/30 01:49:23 INFO CodeGenerator: Code generated in 588.046883 ms
23/07/30 01:49:23 INFO CodeGenerator: Code generated in 275.357676 ms
23/07/30 01:49:23 INFO FileScanRDD: Reading File path: file:///home/mattnhb/Clonadinhos/feature_store/AGGREGATED/visao=cliente/data_processamento=2023-07-30/part-00001-fb503302-9768-4ee9-b268-bd97edead53a.c000.snappy.parquet, range: 0-2110623, partition values: [19568]
23/07/30 01:49:23 INFO FileScanRDD: Reading File path: file:///home/mattnhb/Clonadinhos/feature_store/AGGREGATED/visao=cliente/data_processamento=2023-07-30/part-00000-fb503302-9768-4ee9-b268-bd97edead53a.c000.snappy.parquet, range: 0-2123520, partition values: [19568]
23/07/30 01:49:24 INFO InternalParquetRecordReader: RecordReader initialized will read a total of 29 records.
23/07/30 01:49:24 INFO InternalParquetRecordReader: RecordReader initialized will read a total of 31 records.
23/07/30 01:49:24 INFO InternalParquetRecordReader: at row 0. reading next block
23/07/30 01:49:24 INFO InternalParquetRecordReader: at row 0. reading next block
23/07/30 01:49:24 INFO CodecPool: Got brand-new decompressor [.snappy]
23/07/30 01:49:24 INFO CodecPool: Got brand-new decompressor [.snappy]
23/07/30 01:49:24 INFO InternalParquetRecordReader: block read in memory in 75 ms. row count = 31
23/07/30 01:49:24 INFO InternalParquetRecordReader: block read in memory in 75 ms. row count = 29
23/07/30 01:49:24 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 2175 bytes result sent to driver
23/07/30 01:49:24 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 2175 bytes result sent to driver
23/07/30 01:49:24 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2172 ms on 172.20.232.170 (executor driver) (1/2)
23/07/30 01:49:24 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2174 ms on 172.20.232.170 (executor driver) (2/2)
23/07/30 01:49:24 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
23/07/30 01:49:24 INFO DAGScheduler: ShuffleMapStage 1 (javaToPython at NativeMethodAccessorImpl.java:0) finished in 2.230 s
23/07/30 01:49:24 INFO DAGScheduler: looking for newly runnable stages
23/07/30 01:49:24 INFO DAGScheduler: running: Set()
23/07/30 01:49:24 INFO DAGScheduler: waiting: Set()
23/07/30 01:49:24 INFO DAGScheduler: failed: Set()
df.rdd.getNumPartitions()=10
23/07/30 01:49:24 INFO DataSourceStrategy: Pruning directories with: isnotnull(data_processamento#3),(data_processamento#3 = 2023-07-30)
23/07/30 01:49:24 INFO FileSourceStrategy: Pushed Filters: 
23/07/30 01:49:24 INFO FileSourceStrategy: Post-Scan Filters: 
23/07/30 01:49:24 INFO FileSourceStrategy: Output Data Schema: struct<cod_chav_patc: string, cod_orde_tran: string, metricas: struct<contactless_sem_autentificacao: struct<ultimos_180_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_270_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_30_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_365_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_7_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field> ... 1 more field>, debito_com_autenticacao: struct<ultimos_180_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_270_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_30_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_365_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_7_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field> ... 1 more field>, debito_sem_autenticacao: struct<ultimos_180_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_270_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_30_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_365_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_7_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field> ... 1 more field>, geral: struct<ultimos_180_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_270_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_30_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_365_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field>, ultimos_7_dias: struct<dia_17_24: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, dia_25_31: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, diurno: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, final_semana: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>, geral: struct<countDistinctEstabelecimento: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields> ... 1 more field> ... 1 more field> ... 2 more fields> ... 1 more fields>
23/07/30 01:49:24 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 1807.7 KiB, free 2000.7 MiB)
23/07/30 01:49:24 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 63.4 KiB, free 2000.7 MiB)
23/07/30 01:49:24 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.20.232.170:34743 (size: 63.4 KiB, free: 2004.5 MiB)
23/07/30 01:49:24 INFO SparkContext: Created broadcast 3 from showString at NativeMethodAccessorImpl.java:0
23/07/30 01:49:24 INFO InMemoryFileIndex: Selected 1 partitions out of 2, pruned 50.0% partitions.
23/07/30 01:49:24 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/07/30 01:49:24 INFO DAGScheduler: Registering RDD 15 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 1
23/07/30 01:49:24 INFO DAGScheduler: Got map stage job 2 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/07/30 01:49:24 INFO DAGScheduler: Final stage: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:24 INFO DAGScheduler: Parents of final stage: List()
23/07/30 01:49:24 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:24 INFO DAGScheduler: Submitting ShuffleMapStage 2 (MapPartitionsRDD[15] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:24 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 357.7 KiB, free 2000.3 MiB)
23/07/30 01:49:24 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 19.2 KiB, free 2000.3 MiB)
23/07/30 01:49:24 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.20.232.170:34743 (size: 19.2 KiB, free: 2004.4 MiB)
23/07/30 01:49:24 INFO SparkContext: Created broadcast 4 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:24 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[15] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/07/30 01:49:24 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
23/07/30 01:49:24 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (172.20.232.170, executor driver, partition 0, PROCESS_LOCAL, 5039 bytes) taskResourceAssignments Map()
23/07/30 01:49:24 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 4) (172.20.232.170, executor driver, partition 1, PROCESS_LOCAL, 5039 bytes) taskResourceAssignments Map()
23/07/30 01:49:24 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
23/07/30 01:49:24 INFO Executor: Running task 1.0 in stage 2.0 (TID 4)
23/07/30 01:49:25 INFO FileScanRDD: Reading File path: file:///home/mattnhb/Clonadinhos/feature_store/AGGREGATED/visao=cliente/data_processamento=2023-07-30/part-00000-fb503302-9768-4ee9-b268-bd97edead53a.c000.snappy.parquet, range: 0-2123520, partition values: [19568]
23/07/30 01:49:25 INFO FileScanRDD: Reading File path: file:///home/mattnhb/Clonadinhos/feature_store/AGGREGATED/visao=cliente/data_processamento=2023-07-30/part-00001-fb503302-9768-4ee9-b268-bd97edead53a.c000.snappy.parquet, range: 0-2110623, partition values: [19568]
23/07/30 01:49:25 INFO InternalParquetRecordReader: RecordReader initialized will read a total of 31 records.
23/07/30 01:49:25 INFO InternalParquetRecordReader: RecordReader initialized will read a total of 29 records.
23/07/30 01:49:25 INFO InternalParquetRecordReader: at row 0. reading next block
23/07/30 01:49:25 INFO InternalParquetRecordReader: at row 0. reading next block
23/07/30 01:49:25 INFO InternalParquetRecordReader: block read in memory in 22 ms. row count = 29
23/07/30 01:49:25 INFO InternalParquetRecordReader: block read in memory in 23 ms. row count = 31
23/07/30 01:49:25 INFO BlockManagerInfo: Removed broadcast_2_piece0 on 172.20.232.170:34743 in memory (size: 16.1 KiB, free: 2004.5 MiB)
23/07/30 01:49:25 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 2175 bytes result sent to driver
23/07/30 01:49:25 INFO Executor: Finished task 1.0 in stage 2.0 (TID 4). 2175 bytes result sent to driver
23/07/30 01:49:25 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 4) in 733 ms on 172.20.232.170 (executor driver) (1/2)
23/07/30 01:49:25 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 733 ms on 172.20.232.170 (executor driver) (2/2)
23/07/30 01:49:25 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
23/07/30 01:49:25 INFO DAGScheduler: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0) finished in 0.744 s
23/07/30 01:49:25 INFO DAGScheduler: looking for newly runnable stages
23/07/30 01:49:25 INFO DAGScheduler: running: Set()
23/07/30 01:49:25 INFO DAGScheduler: waiting: Set()
23/07/30 01:49:25 INFO DAGScheduler: failed: Set()
23/07/30 01:49:25 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/07/30 01:49:25 INFO DAGScheduler: Got job 3 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/07/30 01:49:25 INFO DAGScheduler: Final stage: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:25 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 3)
23/07/30 01:49:25 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:25 INFO DAGScheduler: Submitting ResultStage 4 (MapPartitionsRDD[18] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:25 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 360.6 KiB, free 2000.2 MiB)
23/07/30 01:49:25 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 21.0 KiB, free 2000.2 MiB)
23/07/30 01:49:25 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.20.232.170:34743 (size: 21.0 KiB, free: 2004.4 MiB)
23/07/30 01:49:25 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:25 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 4 (MapPartitionsRDD[18] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/07/30 01:49:25 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks resource profile 0
23/07/30 01:49:25 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 5) (172.20.232.170, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
23/07/30 01:49:25 INFO Executor: Running task 0.0 in stage 4.0 (TID 5)
23/07/30 01:49:25 INFO ShuffleBlockFetcherIterator: Getting 2 (7.4 KiB) non-empty blocks including 2 (7.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
23/07/30 01:49:25 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 5 ms
23/07/30 01:49:26 INFO CodeGenerator: Code generated in 366.187368 ms
23/07/30 01:49:26 INFO Executor: Finished task 0.0 in stage 4.0 (TID 5). 6716 bytes result sent to driver
23/07/30 01:49:26 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 5) in 657 ms on 172.20.232.170 (executor driver) (1/1)
23/07/30 01:49:26 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool 
23/07/30 01:49:26 INFO DAGScheduler: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0) finished in 0.674 s
23/07/30 01:49:26 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
23/07/30 01:49:26 INFO TaskSchedulerImpl: Killing all running tasks in stage 4: Stage finished
23/07/30 01:49:26 INFO DAGScheduler: Job 3 finished: showString at NativeMethodAccessorImpl.java:0, took 0.680678 s
23/07/30 01:49:26 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/07/30 01:49:26 INFO DAGScheduler: Got job 4 (showString at NativeMethodAccessorImpl.java:0) with 4 output partitions
23/07/30 01:49:26 INFO DAGScheduler: Final stage: ResultStage 6 (showString at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:26 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 5)
23/07/30 01:49:26 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:26 INFO DAGScheduler: Submitting ResultStage 6 (MapPartitionsRDD[18] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:26 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 360.6 KiB, free 1999.9 MiB)
23/07/30 01:49:26 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 21.0 KiB, free 1999.8 MiB)
23/07/30 01:49:26 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.20.232.170:34743 (size: 21.0 KiB, free: 2004.4 MiB)
23/07/30 01:49:26 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:26 INFO DAGScheduler: Submitting 4 missing tasks from ResultStage 6 (MapPartitionsRDD[18] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(1, 2, 3, 4))
23/07/30 01:49:26 INFO TaskSchedulerImpl: Adding task set 6.0 with 4 tasks resource profile 0
23/07/30 01:49:26 INFO TaskSetManager: Starting task 0.0 in stage 6.0 (TID 6) (172.20.232.170, executor driver, partition 1, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
23/07/30 01:49:26 INFO TaskSetManager: Starting task 1.0 in stage 6.0 (TID 7) (172.20.232.170, executor driver, partition 2, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
23/07/30 01:49:26 INFO TaskSetManager: Starting task 2.0 in stage 6.0 (TID 8) (172.20.232.170, executor driver, partition 3, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
23/07/30 01:49:26 INFO TaskSetManager: Starting task 3.0 in stage 6.0 (TID 9) (172.20.232.170, executor driver, partition 4, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
23/07/30 01:49:26 INFO Executor: Running task 0.0 in stage 6.0 (TID 6)
23/07/30 01:49:26 INFO Executor: Running task 1.0 in stage 6.0 (TID 7)
23/07/30 01:49:26 INFO Executor: Running task 2.0 in stage 6.0 (TID 8)
23/07/30 01:49:26 INFO Executor: Running task 3.0 in stage 6.0 (TID 9)
23/07/30 01:49:26 INFO ShuffleBlockFetcherIterator: Getting 2 (7.8 KiB) non-empty blocks including 2 (7.8 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
23/07/30 01:49:26 INFO ShuffleBlockFetcherIterator: Getting 2 (8.3 KiB) non-empty blocks including 2 (8.3 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
23/07/30 01:49:26 INFO ShuffleBlockFetcherIterator: Getting 2 (10.9 KiB) non-empty blocks including 2 (10.9 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
23/07/30 01:49:26 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
23/07/30 01:49:26 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
23/07/30 01:49:26 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
23/07/30 01:49:26 INFO ShuffleBlockFetcherIterator: Getting 2 (7.1 KiB) non-empty blocks including 2 (7.1 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
23/07/30 01:49:26 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
23/07/30 01:49:26 INFO BlockManagerInfo: Removed broadcast_5_piece0 on 172.20.232.170:34743 in memory (size: 21.0 KiB, free: 2004.4 MiB)
23/07/30 01:49:26 INFO Executor: Finished task 1.0 in stage 6.0 (TID 7). 6526 bytes result sent to driver
23/07/30 01:49:26 INFO TaskSetManager: Finished task 1.0 in stage 6.0 (TID 7) in 272 ms on 172.20.232.170 (executor driver) (1/4)
23/07/30 01:49:26 INFO Executor: Finished task 0.0 in stage 6.0 (TID 6). 7610 bytes result sent to driver
23/07/30 01:49:26 INFO TaskSetManager: Finished task 0.0 in stage 6.0 (TID 6) in 275 ms on 172.20.232.170 (executor driver) (2/4)
23/07/30 01:49:26 INFO Executor: Finished task 3.0 in stage 6.0 (TID 9). 9808 bytes result sent to driver
23/07/30 01:49:26 INFO TaskSetManager: Finished task 3.0 in stage 6.0 (TID 9) in 281 ms on 172.20.232.170 (executor driver) (3/4)
23/07/30 01:49:26 INFO Executor: Finished task 2.0 in stage 6.0 (TID 8). 7053 bytes result sent to driver
23/07/30 01:49:26 INFO TaskSetManager: Finished task 2.0 in stage 6.0 (TID 8) in 288 ms on 172.20.232.170 (executor driver) (4/4)
23/07/30 01:49:26 INFO TaskSchedulerImpl: Removed TaskSet 6.0, whose tasks have all completed, from pool 
23/07/30 01:49:26 INFO DAGScheduler: ResultStage 6 (showString at NativeMethodAccessorImpl.java:0) finished in 0.296 s
23/07/30 01:49:26 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
23/07/30 01:49:26 INFO TaskSchedulerImpl: Killing all running tasks in stage 6: Stage finished
23/07/30 01:49:26 INFO DAGScheduler: Job 4 finished: showString at NativeMethodAccessorImpl.java:0, took 0.298803 s
23/07/30 01:49:26 INFO CodeGenerator: Code generated in 6.994269 ms
+--------------------+-------------+--------------------+
|       cod_chav_patc|cod_orde_tran|            metricas|
+--------------------+-------------+--------------------+
|8ecb4971-18c8-4ce...|      cliente|{{{{0, 0, 0, 0, 0...|
|fefd320b-f5ef-4a9...|      cliente|{{{{0, 0, 0, 0, 0...|
|35e1392e-8a74-4ec...|      cliente|{{{{0, 0, 0, 0, 0...|
|9d0b6f5e-196d-462...|      cliente|{{{{0, 0, 0, 0, 0...|
|aa170666-9b6e-43a...|      cliente|{{{{0, 0, 0, 0, 0...|
|37503d77-3367-475...|      cliente|{{{{0, 0, 0, 0, 0...|
|fff99f34-f94d-410...|      cliente|{{{{0, 0, 0, 0, 0...|
|debaa89f-559d-420...|      cliente|{{{{0, 0, 0, 0, 0...|
|312a4c3c-7f00-425...|      cliente|{{{{1, 2023-07-21...|
|3e332f35-086c-476...|      cliente|{{{{0, 0, 0, 0, 0...|
|dd153fb4-9680-41b...|      cliente|{{{{0, 0, 0, 0, 0...|
|f63d307c-a9d2-4bf...|      cliente|{{{{0, 0, 0, 0, 0...|
|438dc8b1-9719-44f...|      cliente|{{{{0, 0, 0, 0, 0...|
|ec4f4490-84ea-494...|      cliente|{{{{1, 2023-07-23...|
|62614790-43a0-41c...|      cliente|{{{{0, 0, 0, 0, 0...|
|ac98a368-dfc8-487...|      cliente|{{{{0, 0, 0, 0, 0...|
|e2aa55a7-4951-43e...|      cliente|{{{{1, 2023-07-24...|
|c2fab184-2232-467...|      cliente|{{{{0, 0, 0, 0, 0...|
|7c3ad037-20d5-416...|      cliente|{{{{0, 0, 0, 0, 0...|
|c82a6c15-d733-466...|      cliente|{{{{0, 0, 0, 0, 0...|
+--------------------+-------------+--------------------+
only showing top 20 rows

23/07/30 01:49:26 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
23/07/30 01:49:26 INFO SparkContext: Starting job: load at NativeMethodAccessorImpl.java:0
23/07/30 01:49:26 INFO DAGScheduler: Got job 5 (load at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/07/30 01:49:26 INFO DAGScheduler: Final stage: ResultStage 7 (load at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:26 INFO DAGScheduler: Parents of final stage: List()
23/07/30 01:49:26 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:26 INFO DAGScheduler: Submitting ResultStage 7 (MapPartitionsRDD[20] at load at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:26 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 102.9 KiB, free 2000.1 MiB)
23/07/30 01:49:26 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 37.1 KiB, free 2000.1 MiB)
23/07/30 01:49:26 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.20.232.170:34743 (size: 37.1 KiB, free: 2004.4 MiB)
23/07/30 01:49:26 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:26 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 7 (MapPartitionsRDD[20] at load at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/07/30 01:49:26 INFO TaskSchedulerImpl: Adding task set 7.0 with 1 tasks resource profile 0
23/07/30 01:49:26 INFO TaskSetManager: Starting task 0.0 in stage 7.0 (TID 10) (172.20.232.170, executor driver, partition 0, PROCESS_LOCAL, 4723 bytes) taskResourceAssignments Map()
23/07/30 01:49:26 INFO Executor: Running task 0.0 in stage 7.0 (TID 10)
23/07/30 01:49:26 INFO Executor: Finished task 0.0 in stage 7.0 (TID 10). 42444 bytes result sent to driver
23/07/30 01:49:26 INFO TaskSetManager: Finished task 0.0 in stage 7.0 (TID 10) in 11 ms on 172.20.232.170 (executor driver) (1/1)
23/07/30 01:49:26 INFO TaskSchedulerImpl: Removed TaskSet 7.0, whose tasks have all completed, from pool 
23/07/30 01:49:26 INFO DAGScheduler: ResultStage 7 (load at NativeMethodAccessorImpl.java:0) finished in 0.018 s
23/07/30 01:49:26 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
23/07/30 01:49:26 INFO TaskSchedulerImpl: Killing all running tasks in stage 7: Stage finished
23/07/30 01:49:26 INFO DAGScheduler: Job 5 finished: load at NativeMethodAccessorImpl.java:0, took 0.020279 s
23/07/30 01:49:26 INFO DataSourceStrategy: Pruning directories with: isnotnull(data_processamento#44),(data_processamento#44 = 2023-07-30)
23/07/30 01:49:26 INFO FileSourceStrategy: Pushed Filters: 
23/07/30 01:49:26 INFO FileSourceStrategy: Post-Scan Filters: 
23/07/30 01:49:26 INFO FileSourceStrategy: Output Data Schema: struct<cod_chav_patc: string, cod_orde_tran: string, metricas: struct<contactless_sem_autentificacao: struct<ultimos_180_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_270_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_30_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_365_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_7_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>> ... 1 more field>, debito_com_autenticacao: struct<ultimos_180_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_270_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_30_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_365_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_7_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>> ... 1 more field>, debito_sem_autenticacao: struct<ultimos_180_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_270_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_30_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_365_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_7_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>> ... 1 more field>, geral: struct<ultimos_180_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_270_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_30_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_365_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_7_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>> ... 1 more field> ... 2 more fields> ... 1 more fields>
23/07/30 01:49:26 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 604.4 KiB, free 1999.5 MiB)
23/07/30 01:49:26 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 42.1 KiB, free 1999.4 MiB)
23/07/30 01:49:26 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.20.232.170:34743 (size: 42.1 KiB, free: 2004.4 MiB)
23/07/30 01:49:26 INFO SparkContext: Created broadcast 8 from javaToPython at NativeMethodAccessorImpl.java:0
23/07/30 01:49:26 INFO InMemoryFileIndex: Selected 1 partitions out of 1, pruned 0.0% partitions.
23/07/30 01:49:26 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/07/30 01:49:26 INFO DAGScheduler: Registering RDD 25 (javaToPython at NativeMethodAccessorImpl.java:0) as input to shuffle 2
23/07/30 01:49:26 INFO DAGScheduler: Got map stage job 6 (javaToPython at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/07/30 01:49:26 INFO DAGScheduler: Final stage: ShuffleMapStage 8 (javaToPython at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:26 INFO DAGScheduler: Parents of final stage: List()
23/07/30 01:49:26 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:26 INFO DAGScheduler: Submitting ShuffleMapStage 8 (MapPartitionsRDD[25] at javaToPython at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:26 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 59.5 KiB, free 1999.4 MiB)
23/07/30 01:49:26 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 11.5 KiB, free 1999.4 MiB)
23/07/30 01:49:26 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.20.232.170:34743 (size: 11.5 KiB, free: 2004.3 MiB)
23/07/30 01:49:26 INFO SparkContext: Created broadcast 9 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:26 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 8 (MapPartitionsRDD[25] at javaToPython at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/07/30 01:49:26 INFO TaskSchedulerImpl: Adding task set 8.0 with 1 tasks resource profile 0
23/07/30 01:49:26 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 11) (172.20.232.170, executor driver, partition 0, PROCESS_LOCAL, 5047 bytes) taskResourceAssignments Map()
23/07/30 01:49:26 INFO Executor: Running task 0.0 in stage 8.0 (TID 11)
23/07/30 01:49:26 INFO CodeGenerator: Code generated in 47.806847 ms
23/07/30 01:49:27 INFO CodeGenerator: Code generated in 37.817631 ms
23/07/30 01:49:27 INFO FileScanRDD: Reading File path: file:///home/mattnhb/Clonadinhos/feature_store/AGGREGATED/visao=estabelecimento/data_processamento=2023-07-30/part-00000-251e4162-66ce-40fe-b862-7e2dd46ace5d.c000.snappy.parquet, range: 0-436535, partition values: [19568]
23/07/30 01:49:27 INFO InternalParquetRecordReader: RecordReader initialized will read a total of 62 records.
23/07/30 01:49:27 INFO InternalParquetRecordReader: at row 0. reading next block
23/07/30 01:49:27 INFO InternalParquetRecordReader: block read in memory in 4 ms. row count = 62
23/07/30 01:49:27 INFO Executor: Finished task 0.0 in stage 8.0 (TID 11). 2132 bytes result sent to driver
23/07/30 01:49:27 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 11) in 182 ms on 172.20.232.170 (executor driver) (1/1)
23/07/30 01:49:27 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
23/07/30 01:49:27 INFO DAGScheduler: ShuffleMapStage 8 (javaToPython at NativeMethodAccessorImpl.java:0) finished in 0.197 s
23/07/30 01:49:27 INFO DAGScheduler: looking for newly runnable stages
23/07/30 01:49:27 INFO DAGScheduler: running: Set()
23/07/30 01:49:27 INFO DAGScheduler: waiting: Set()
23/07/30 01:49:27 INFO DAGScheduler: failed: Set()
df.rdd.getNumPartitions()=10
23/07/30 01:49:27 INFO DataSourceStrategy: Pruning directories with: isnotnull(data_processamento#44),(data_processamento#44 = 2023-07-30)
23/07/30 01:49:27 INFO FileSourceStrategy: Pushed Filters: 
23/07/30 01:49:27 INFO FileSourceStrategy: Post-Scan Filters: 
23/07/30 01:49:27 INFO FileSourceStrategy: Output Data Schema: struct<cod_chav_patc: string, cod_orde_tran: string, metricas: struct<contactless_sem_autentificacao: struct<ultimos_180_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_270_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_30_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_365_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_7_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>> ... 1 more field>, debito_com_autenticacao: struct<ultimos_180_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_270_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_30_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_365_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_7_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>> ... 1 more field>, debito_sem_autenticacao: struct<ultimos_180_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_270_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_30_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_365_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_7_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>> ... 1 more field>, geral: struct<ultimos_180_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_270_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_30_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_365_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>>, ultimos_7_dias: struct<geral: struct<countDistinctCliente: bigint, maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint ... 33 more fields>> ... 1 more field> ... 2 more fields> ... 1 more fields>
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 604.4 KiB, free 1998.8 MiB)
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 42.1 KiB, free 1998.7 MiB)
23/07/30 01:49:27 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.20.232.170:34743 (size: 42.1 KiB, free: 2004.3 MiB)
23/07/30 01:49:27 INFO SparkContext: Created broadcast 10 from showString at NativeMethodAccessorImpl.java:0
23/07/30 01:49:27 INFO InMemoryFileIndex: Selected 1 partitions out of 1, pruned 0.0% partitions.
23/07/30 01:49:27 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/07/30 01:49:27 INFO DAGScheduler: Registering RDD 34 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 3
23/07/30 01:49:27 INFO DAGScheduler: Got map stage job 7 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/07/30 01:49:27 INFO DAGScheduler: Final stage: ShuffleMapStage 9 (showString at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:27 INFO DAGScheduler: Parents of final stage: List()
23/07/30 01:49:27 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:27 INFO DAGScheduler: Submitting ShuffleMapStage 9 (MapPartitionsRDD[34] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 78.2 KiB, free 1998.7 MiB)
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 1998.6 MiB)
23/07/30 01:49:27 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.20.232.170:34743 (size: 12.8 KiB, free: 2004.3 MiB)
23/07/30 01:49:27 INFO SparkContext: Created broadcast 11 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:27 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 9 (MapPartitionsRDD[34] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/07/30 01:49:27 INFO TaskSchedulerImpl: Adding task set 9.0 with 1 tasks resource profile 0
23/07/30 01:49:27 INFO TaskSetManager: Starting task 0.0 in stage 9.0 (TID 12) (172.20.232.170, executor driver, partition 0, PROCESS_LOCAL, 5047 bytes) taskResourceAssignments Map()
23/07/30 01:49:27 INFO Executor: Running task 0.0 in stage 9.0 (TID 12)
23/07/30 01:49:27 INFO FileScanRDD: Reading File path: file:///home/mattnhb/Clonadinhos/feature_store/AGGREGATED/visao=estabelecimento/data_processamento=2023-07-30/part-00000-251e4162-66ce-40fe-b862-7e2dd46ace5d.c000.snappy.parquet, range: 0-436535, partition values: [19568]
23/07/30 01:49:27 INFO InternalParquetRecordReader: RecordReader initialized will read a total of 62 records.
23/07/30 01:49:27 INFO InternalParquetRecordReader: at row 0. reading next block
23/07/30 01:49:27 INFO InternalParquetRecordReader: block read in memory in 3 ms. row count = 62
23/07/30 01:49:27 INFO Executor: Finished task 0.0 in stage 9.0 (TID 12). 2132 bytes result sent to driver
23/07/30 01:49:27 INFO TaskSetManager: Finished task 0.0 in stage 9.0 (TID 12) in 84 ms on 172.20.232.170 (executor driver) (1/1)
23/07/30 01:49:27 INFO TaskSchedulerImpl: Removed TaskSet 9.0, whose tasks have all completed, from pool 
23/07/30 01:49:27 INFO DAGScheduler: ShuffleMapStage 9 (showString at NativeMethodAccessorImpl.java:0) finished in 0.090 s
23/07/30 01:49:27 INFO DAGScheduler: looking for newly runnable stages
23/07/30 01:49:27 INFO DAGScheduler: running: Set()
23/07/30 01:49:27 INFO DAGScheduler: waiting: Set()
23/07/30 01:49:27 INFO DAGScheduler: failed: Set()
23/07/30 01:49:27 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/07/30 01:49:27 INFO DAGScheduler: Got job 8 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/07/30 01:49:27 INFO DAGScheduler: Final stage: ResultStage 11 (showString at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:27 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 10)
23/07/30 01:49:27 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:27 INFO DAGScheduler: Submitting ResultStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 81.5 KiB, free 1998.6 MiB)
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 14.6 KiB, free 1998.6 MiB)
23/07/30 01:49:27 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.20.232.170:34743 (size: 14.6 KiB, free: 2004.3 MiB)
23/07/30 01:49:27 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:27 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/07/30 01:49:27 INFO TaskSchedulerImpl: Adding task set 11.0 with 1 tasks resource profile 0
23/07/30 01:49:27 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 13) (172.20.232.170, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
23/07/30 01:49:27 INFO Executor: Running task 0.0 in stage 11.0 (TID 13)
23/07/30 01:49:27 INFO ShuffleBlockFetcherIterator: Getting 1 (3.9 KiB) non-empty blocks including 1 (3.9 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
23/07/30 01:49:27 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
23/07/30 01:49:27 INFO CodeGenerator: Code generated in 42.976494 ms
23/07/30 01:49:27 INFO Executor: Finished task 0.0 in stage 11.0 (TID 13). 5995 bytes result sent to driver
23/07/30 01:49:27 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 13) in 87 ms on 172.20.232.170 (executor driver) (1/1)
23/07/30 01:49:27 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
23/07/30 01:49:27 INFO DAGScheduler: ResultStage 11 (showString at NativeMethodAccessorImpl.java:0) finished in 0.096 s
23/07/30 01:49:27 INFO DAGScheduler: Job 8 is finished. Cancelling potential speculative or zombie tasks for this job
23/07/30 01:49:27 INFO TaskSchedulerImpl: Killing all running tasks in stage 11: Stage finished
23/07/30 01:49:27 INFO DAGScheduler: Job 8 finished: showString at NativeMethodAccessorImpl.java:0, took 0.097440 s
23/07/30 01:49:27 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/07/30 01:49:27 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 3 output partitions
23/07/30 01:49:27 INFO DAGScheduler: Final stage: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:27 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
23/07/30 01:49:27 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:27 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 81.5 KiB, free 1998.5 MiB)
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 14.7 KiB, free 1998.5 MiB)
23/07/30 01:49:27 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.20.232.170:34743 (size: 14.7 KiB, free: 2004.3 MiB)
23/07/30 01:49:27 INFO SparkContext: Created broadcast 13 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:27 INFO DAGScheduler: Submitting 3 missing tasks from ResultStage 13 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(1, 2, 3))
23/07/30 01:49:27 INFO TaskSchedulerImpl: Adding task set 13.0 with 3 tasks resource profile 0
23/07/30 01:49:27 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 14) (172.20.232.170, executor driver, partition 1, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
23/07/30 01:49:27 INFO TaskSetManager: Starting task 1.0 in stage 13.0 (TID 15) (172.20.232.170, executor driver, partition 2, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
23/07/30 01:49:27 INFO TaskSetManager: Starting task 2.0 in stage 13.0 (TID 16) (172.20.232.170, executor driver, partition 3, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
23/07/30 01:49:27 INFO Executor: Running task 0.0 in stage 13.0 (TID 14)
23/07/30 01:49:27 INFO Executor: Running task 1.0 in stage 13.0 (TID 15)
23/07/30 01:49:27 INFO Executor: Running task 2.0 in stage 13.0 (TID 16)
23/07/30 01:49:27 INFO ShuffleBlockFetcherIterator: Getting 1 (2.7 KiB) non-empty blocks including 1 (2.7 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
23/07/30 01:49:27 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
23/07/30 01:49:27 INFO ShuffleBlockFetcherIterator: Getting 1 (3.5 KiB) non-empty blocks including 1 (3.5 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
23/07/30 01:49:27 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
23/07/30 01:49:27 INFO ShuffleBlockFetcherIterator: Getting 1 (2.2 KiB) non-empty blocks including 1 (2.2 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
23/07/30 01:49:27 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
23/07/30 01:49:27 INFO BlockManagerInfo: Removed broadcast_9_piece0 on 172.20.232.170:34743 in memory (size: 11.5 KiB, free: 2004.3 MiB)
23/07/30 01:49:27 INFO BlockManagerInfo: Removed broadcast_11_piece0 on 172.20.232.170:34743 in memory (size: 12.8 KiB, free: 2004.3 MiB)
23/07/30 01:49:27 INFO BlockManagerInfo: Removed broadcast_12_piece0 on 172.20.232.170:34743 in memory (size: 14.6 KiB, free: 2004.3 MiB)
23/07/30 01:49:27 INFO BlockManagerInfo: Removed broadcast_7_piece0 on 172.20.232.170:34743 in memory (size: 37.1 KiB, free: 2004.3 MiB)
23/07/30 01:49:27 INFO Executor: Finished task 0.0 in stage 13.0 (TID 14). 5085 bytes result sent to driver
23/07/30 01:49:27 INFO Executor: Finished task 2.0 in stage 13.0 (TID 16). 4459 bytes result sent to driver
23/07/30 01:49:27 INFO Executor: Finished task 1.0 in stage 13.0 (TID 15). 5547 bytes result sent to driver
23/07/30 01:49:27 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 14) in 64 ms on 172.20.232.170 (executor driver) (1/3)
23/07/30 01:49:27 INFO TaskSetManager: Finished task 2.0 in stage 13.0 (TID 16) in 65 ms on 172.20.232.170 (executor driver) (2/3)
23/07/30 01:49:27 INFO TaskSetManager: Finished task 1.0 in stage 13.0 (TID 15) in 65 ms on 172.20.232.170 (executor driver) (3/3)
23/07/30 01:49:27 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
23/07/30 01:49:27 INFO DAGScheduler: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0) finished in 0.070 s
23/07/30 01:49:27 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
23/07/30 01:49:27 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
23/07/30 01:49:27 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 0.072165 s
+--------------------+---------------+--------------------+
|       cod_chav_patc|  cod_orde_tran|            metricas|
+--------------------+---------------+--------------------+
|2c94151d-52fa-493...|estabelecimento|{{{{0, 0, 0, 0, 0...|
|b55dc442-c884-466...|estabelecimento|{{{{1, 2023-07-22...|
|8f5a5ade-c21d-4ea...|estabelecimento|{{{{1, 2023-07-20...|
|112930f2-cf21-4e6...|estabelecimento|{{{{0, 0, 0, 0, 0...|
|0044c690-f17a-4c8...|estabelecimento|{{{{0, 0, 0, 0, 0...|
|bac114b5-ca19-45a...|estabelecimento|{{{{0, 0, 0, 0, 0...|
|623a35ae-7a31-427...|estabelecimento|{{{{0, 0, 0, 0, 0...|
|72e55360-e3ae-412...|estabelecimento|{{{{1, 2023-07-27...|
|649ec503-3c73-4ae...|estabelecimento|{{{{0, 0, 0, 0, 0...|
|94d7f681-d551-4e1...|estabelecimento|{{{{1, 2023-07-24...|
|fabbc6b6-97f4-4de...|estabelecimento|{{{{1, 2023-07-21...|
|3b239fd8-0d20-468...|estabelecimento|{{{{0, 0, 0, 0, 0...|
|68bfbf7e-d4dc-430...|estabelecimento|{{{{0, 0, 0, 0, 0...|
|1d5a474c-cda8-40f...|estabelecimento|{{{{1, 2023-07-25...|
|80635ef2-e534-48b...|estabelecimento|{{{{0, 0, 0, 0, 0...|
|d8efb5c9-e7a2-42d...|estabelecimento|{{{{1, 2023-07-28...|
|faa2cbad-467a-4bd...|estabelecimento|{{{{1, 2023-07-20...|
|daace3a3-c2f8-4ef...|estabelecimento|{{{{0, 0, 0, 0, 0...|
|98decbf6-4273-4d1...|estabelecimento|{{{{0, 0, 0, 0, 0...|
|6ef4d6b4-424c-422...|estabelecimento|{{{{0, 0, 0, 0, 0...|
+--------------------+---------------+--------------------+
only showing top 20 rows

23/07/30 01:49:27 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
23/07/30 01:49:27 INFO SparkContext: Starting job: load at NativeMethodAccessorImpl.java:0
23/07/30 01:49:27 INFO DAGScheduler: Got job 10 (load at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/07/30 01:49:27 INFO DAGScheduler: Final stage: ResultStage 14 (load at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:27 INFO DAGScheduler: Parents of final stage: List()
23/07/30 01:49:27 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:27 INFO DAGScheduler: Submitting ResultStage 14 (MapPartitionsRDD[39] at load at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 102.9 KiB, free 1998.7 MiB)
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 37.1 KiB, free 1998.7 MiB)
23/07/30 01:49:27 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.20.232.170:34743 (size: 37.1 KiB, free: 2004.3 MiB)
23/07/30 01:49:27 INFO SparkContext: Created broadcast 14 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:27 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 14 (MapPartitionsRDD[39] at load at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/07/30 01:49:27 INFO TaskSchedulerImpl: Adding task set 14.0 with 1 tasks resource profile 0
23/07/30 01:49:27 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 17) (172.20.232.170, executor driver, partition 0, PROCESS_LOCAL, 4731 bytes) taskResourceAssignments Map()
23/07/30 01:49:27 INFO Executor: Running task 0.0 in stage 14.0 (TID 17)
23/07/30 01:49:27 INFO Executor: Finished task 0.0 in stage 14.0 (TID 17). 41215 bytes result sent to driver
23/07/30 01:49:27 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 17) in 9 ms on 172.20.232.170 (executor driver) (1/1)
23/07/30 01:49:27 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
23/07/30 01:49:27 INFO DAGScheduler: ResultStage 14 (load at NativeMethodAccessorImpl.java:0) finished in 0.017 s
23/07/30 01:49:27 INFO DAGScheduler: Job 10 is finished. Cancelling potential speculative or zombie tasks for this job
23/07/30 01:49:27 INFO TaskSchedulerImpl: Killing all running tasks in stage 14: Stage finished
23/07/30 01:49:27 INFO DAGScheduler: Job 10 finished: load at NativeMethodAccessorImpl.java:0, took 0.018235 s
23/07/30 01:49:27 INFO DataSourceStrategy: Pruning directories with: isnotnull(data_processamento#77),(data_processamento#77 = 2023-07-30)
23/07/30 01:49:27 INFO FileSourceStrategy: Pushed Filters: 
23/07/30 01:49:27 INFO FileSourceStrategy: Post-Scan Filters: 
23/07/30 01:49:27 INFO FileSourceStrategy: Output Data Schema: struct<cod_chav_patc: string, cod_orde_tran: string, metricas: struct<contactless_sem_autentificacao: struct<ultimos_180_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_270_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_30_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_365_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_7_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>> ... 1 more field>, debito_com_autenticacao: struct<ultimos_180_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_270_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_30_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_365_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_7_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>> ... 1 more field>, debito_sem_autenticacao: struct<ultimos_180_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_270_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_30_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_365_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_7_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>> ... 1 more field>, geral: struct<ultimos_180_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_270_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_30_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_365_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_7_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>> ... 1 more field> ... 2 more fields> ... 1 more fields>
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 597.2 KiB, free 1998.1 MiB)
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 41.2 KiB, free 1998.1 MiB)
23/07/30 01:49:27 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.20.232.170:34743 (size: 41.2 KiB, free: 2004.3 MiB)
23/07/30 01:49:27 INFO SparkContext: Created broadcast 15 from javaToPython at NativeMethodAccessorImpl.java:0
23/07/30 01:49:27 INFO InMemoryFileIndex: Selected 1 partitions out of 1, pruned 0.0% partitions.
23/07/30 01:49:27 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/07/30 01:49:27 INFO DAGScheduler: Registering RDD 44 (javaToPython at NativeMethodAccessorImpl.java:0) as input to shuffle 4
23/07/30 01:49:27 INFO DAGScheduler: Got map stage job 11 (javaToPython at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/07/30 01:49:27 INFO DAGScheduler: Final stage: ShuffleMapStage 15 (javaToPython at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:27 INFO DAGScheduler: Parents of final stage: List()
23/07/30 01:49:27 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:27 INFO DAGScheduler: Submitting ShuffleMapStage 15 (MapPartitionsRDD[44] at javaToPython at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_16 stored as values in memory (estimated size 58.3 KiB, free 1998.0 MiB)
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_16_piece0 stored as bytes in memory (estimated size 11.4 KiB, free 1998.0 MiB)
23/07/30 01:49:27 INFO BlockManagerInfo: Added broadcast_16_piece0 in memory on 172.20.232.170:34743 (size: 11.4 KiB, free: 2004.3 MiB)
23/07/30 01:49:27 INFO SparkContext: Created broadcast 16 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:27 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 15 (MapPartitionsRDD[44] at javaToPython at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/07/30 01:49:27 INFO TaskSchedulerImpl: Adding task set 15.0 with 1 tasks resource profile 0
23/07/30 01:49:27 INFO TaskSetManager: Starting task 0.0 in stage 15.0 (TID 18) (172.20.232.170, executor driver, partition 0, PROCESS_LOCAL, 5055 bytes) taskResourceAssignments Map()
23/07/30 01:49:27 INFO Executor: Running task 0.0 in stage 15.0 (TID 18)
23/07/30 01:49:27 INFO CodeGenerator: Code generated in 31.582762 ms
23/07/30 01:49:27 INFO CodeGenerator: Code generated in 29.404456 ms
23/07/30 01:49:27 INFO FileScanRDD: Reading File path: file:///home/mattnhb/Clonadinhos/feature_store/AGGREGATED/visao=cliente_estabelecimento/data_processamento=2023-07-30/part-00000-6d2fd53f-5128-4d30-93d3-111b19a42f3f.c000.snappy.parquet, range: 0-467413, partition values: [19568]
23/07/30 01:49:27 INFO InternalParquetRecordReader: RecordReader initialized will read a total of 102 records.
23/07/30 01:49:27 INFO InternalParquetRecordReader: at row 0. reading next block
23/07/30 01:49:27 INFO InternalParquetRecordReader: block read in memory in 3 ms. row count = 102
23/07/30 01:49:27 INFO Executor: Finished task 0.0 in stage 15.0 (TID 18). 2132 bytes result sent to driver
23/07/30 01:49:27 INFO TaskSetManager: Finished task 0.0 in stage 15.0 (TID 18) in 151 ms on 172.20.232.170 (executor driver) (1/1)
23/07/30 01:49:27 INFO TaskSchedulerImpl: Removed TaskSet 15.0, whose tasks have all completed, from pool 
23/07/30 01:49:27 INFO DAGScheduler: ShuffleMapStage 15 (javaToPython at NativeMethodAccessorImpl.java:0) finished in 0.158 s
23/07/30 01:49:27 INFO DAGScheduler: looking for newly runnable stages
23/07/30 01:49:27 INFO DAGScheduler: running: Set()
23/07/30 01:49:27 INFO DAGScheduler: waiting: Set()
23/07/30 01:49:27 INFO DAGScheduler: failed: Set()
df.rdd.getNumPartitions()=10
23/07/30 01:49:27 INFO DataSourceStrategy: Pruning directories with: isnotnull(data_processamento#77),(data_processamento#77 = 2023-07-30)
23/07/30 01:49:27 INFO FileSourceStrategy: Pushed Filters: 
23/07/30 01:49:27 INFO FileSourceStrategy: Post-Scan Filters: 
23/07/30 01:49:27 INFO FileSourceStrategy: Output Data Schema: struct<cod_chav_patc: string, cod_orde_tran: string, metricas: struct<contactless_sem_autentificacao: struct<ultimos_180_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_270_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_30_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_365_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_7_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>> ... 1 more field>, debito_com_autenticacao: struct<ultimos_180_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_270_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_30_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_365_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_7_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>> ... 1 more field>, debito_sem_autenticacao: struct<ultimos_180_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_270_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_30_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_365_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_7_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>> ... 1 more field>, geral: struct<ultimos_180_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_270_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_30_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_365_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>>, ultimos_7_dias: struct<geral: struct<maximoDataTransacao: string, minimoDataTransacao: string, maximoValor: bigint, minimoValor: bigint, cluster0to500Valor: bigint ... 32 more fields>> ... 1 more field> ... 2 more fields> ... 1 more fields>
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_17 stored as values in memory (estimated size 597.2 KiB, free 1997.4 MiB)
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_17_piece0 stored as bytes in memory (estimated size 41.2 KiB, free 1997.4 MiB)
23/07/30 01:49:27 INFO BlockManagerInfo: Added broadcast_17_piece0 in memory on 172.20.232.170:34743 (size: 41.2 KiB, free: 2004.2 MiB)
23/07/30 01:49:27 INFO SparkContext: Created broadcast 17 from showString at NativeMethodAccessorImpl.java:0
23/07/30 01:49:27 INFO InMemoryFileIndex: Selected 1 partitions out of 1, pruned 0.0% partitions.
23/07/30 01:49:27 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/07/30 01:49:27 INFO DAGScheduler: Registering RDD 53 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 5
23/07/30 01:49:27 INFO DAGScheduler: Got map stage job 12 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/07/30 01:49:27 INFO DAGScheduler: Final stage: ShuffleMapStage 16 (showString at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:27 INFO DAGScheduler: Parents of final stage: List()
23/07/30 01:49:27 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:27 INFO DAGScheduler: Submitting ShuffleMapStage 16 (MapPartitionsRDD[53] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_18 stored as values in memory (estimated size 76.4 KiB, free 1997.3 MiB)
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_18_piece0 stored as bytes in memory (estimated size 12.5 KiB, free 1997.3 MiB)
23/07/30 01:49:27 INFO BlockManagerInfo: Added broadcast_18_piece0 in memory on 172.20.232.170:34743 (size: 12.5 KiB, free: 2004.2 MiB)
23/07/30 01:49:27 INFO SparkContext: Created broadcast 18 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:27 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 16 (MapPartitionsRDD[53] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/07/30 01:49:27 INFO TaskSchedulerImpl: Adding task set 16.0 with 1 tasks resource profile 0
23/07/30 01:49:27 INFO TaskSetManager: Starting task 0.0 in stage 16.0 (TID 19) (172.20.232.170, executor driver, partition 0, PROCESS_LOCAL, 5055 bytes) taskResourceAssignments Map()
23/07/30 01:49:27 INFO Executor: Running task 0.0 in stage 16.0 (TID 19)
23/07/30 01:49:27 INFO FileScanRDD: Reading File path: file:///home/mattnhb/Clonadinhos/feature_store/AGGREGATED/visao=cliente_estabelecimento/data_processamento=2023-07-30/part-00000-6d2fd53f-5128-4d30-93d3-111b19a42f3f.c000.snappy.parquet, range: 0-467413, partition values: [19568]
23/07/30 01:49:27 INFO InternalParquetRecordReader: RecordReader initialized will read a total of 102 records.
23/07/30 01:49:27 INFO InternalParquetRecordReader: at row 0. reading next block
23/07/30 01:49:27 INFO InternalParquetRecordReader: block read in memory in 3 ms. row count = 102
23/07/30 01:49:27 INFO Executor: Finished task 0.0 in stage 16.0 (TID 19). 2132 bytes result sent to driver
23/07/30 01:49:27 INFO TaskSetManager: Finished task 0.0 in stage 16.0 (TID 19) in 87 ms on 172.20.232.170 (executor driver) (1/1)
23/07/30 01:49:27 INFO TaskSchedulerImpl: Removed TaskSet 16.0, whose tasks have all completed, from pool 
23/07/30 01:49:27 INFO DAGScheduler: ShuffleMapStage 16 (showString at NativeMethodAccessorImpl.java:0) finished in 0.094 s
23/07/30 01:49:27 INFO DAGScheduler: looking for newly runnable stages
23/07/30 01:49:27 INFO DAGScheduler: running: Set()
23/07/30 01:49:27 INFO DAGScheduler: waiting: Set()
23/07/30 01:49:27 INFO DAGScheduler: failed: Set()
23/07/30 01:49:27 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/07/30 01:49:27 INFO DAGScheduler: Got job 13 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/07/30 01:49:27 INFO DAGScheduler: Final stage: ResultStage 18 (showString at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:27 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 17)
23/07/30 01:49:27 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:27 INFO DAGScheduler: Submitting ResultStage 18 (MapPartitionsRDD[56] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_19 stored as values in memory (estimated size 79.7 KiB, free 1997.2 MiB)
23/07/30 01:49:27 INFO MemoryStore: Block broadcast_19_piece0 stored as bytes in memory (estimated size 14.5 KiB, free 1997.2 MiB)
23/07/30 01:49:27 INFO BlockManagerInfo: Added broadcast_19_piece0 in memory on 172.20.232.170:34743 (size: 14.5 KiB, free: 2004.2 MiB)
23/07/30 01:49:27 INFO SparkContext: Created broadcast 19 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:27 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 18 (MapPartitionsRDD[56] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/07/30 01:49:27 INFO TaskSchedulerImpl: Adding task set 18.0 with 1 tasks resource profile 0
23/07/30 01:49:27 INFO TaskSetManager: Starting task 0.0 in stage 18.0 (TID 20) (172.20.232.170, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
23/07/30 01:49:27 INFO Executor: Running task 0.0 in stage 18.0 (TID 20)
23/07/30 01:49:27 INFO ShuffleBlockFetcherIterator: Getting 1 (3.9 KiB) non-empty blocks including 1 (3.9 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
23/07/30 01:49:27 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
23/07/30 01:49:28 INFO CodeGenerator: Code generated in 40.013748 ms
23/07/30 01:49:28 INFO Executor: Finished task 0.0 in stage 18.0 (TID 20). 5972 bytes result sent to driver
23/07/30 01:49:28 INFO TaskSetManager: Finished task 0.0 in stage 18.0 (TID 20) in 84 ms on 172.20.232.170 (executor driver) (1/1)
23/07/30 01:49:28 INFO TaskSchedulerImpl: Removed TaskSet 18.0, whose tasks have all completed, from pool 
23/07/30 01:49:28 INFO DAGScheduler: ResultStage 18 (showString at NativeMethodAccessorImpl.java:0) finished in 0.091 s
23/07/30 01:49:28 INFO DAGScheduler: Job 13 is finished. Cancelling potential speculative or zombie tasks for this job
23/07/30 01:49:28 INFO TaskSchedulerImpl: Killing all running tasks in stage 18: Stage finished
23/07/30 01:49:28 INFO DAGScheduler: Job 13 finished: showString at NativeMethodAccessorImpl.java:0, took 0.092153 s
23/07/30 01:49:28 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/07/30 01:49:28 INFO DAGScheduler: Got job 14 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/07/30 01:49:28 INFO DAGScheduler: Final stage: ResultStage 20 (showString at NativeMethodAccessorImpl.java:0)
23/07/30 01:49:28 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 19)
23/07/30 01:49:28 INFO DAGScheduler: Missing parents: List()
23/07/30 01:49:28 INFO DAGScheduler: Submitting ResultStage 20 (MapPartitionsRDD[56] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/07/30 01:49:28 INFO MemoryStore: Block broadcast_20 stored as values in memory (estimated size 79.7 KiB, free 1997.1 MiB)
23/07/30 01:49:28 INFO MemoryStore: Block broadcast_20_piece0 stored as bytes in memory (estimated size 14.6 KiB, free 1997.1 MiB)
23/07/30 01:49:28 INFO BlockManagerInfo: Added broadcast_20_piece0 in memory on 172.20.232.170:34743 (size: 14.6 KiB, free: 2004.2 MiB)
23/07/30 01:49:28 INFO SparkContext: Created broadcast 20 from broadcast at DAGScheduler.scala:1513
23/07/30 01:49:28 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 20 (MapPartitionsRDD[56] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(1, 2))
23/07/30 01:49:28 INFO TaskSchedulerImpl: Adding task set 20.0 with 2 tasks resource profile 0
23/07/30 01:49:28 INFO TaskSetManager: Starting task 0.0 in stage 20.0 (TID 21) (172.20.232.170, executor driver, partition 1, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
23/07/30 01:49:28 INFO TaskSetManager: Starting task 1.0 in stage 20.0 (TID 22) (172.20.232.170, executor driver, partition 2, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
23/07/30 01:49:28 INFO Executor: Running task 0.0 in stage 20.0 (TID 21)
23/07/30 01:49:28 INFO Executor: Running task 1.0 in stage 20.0 (TID 22)
23/07/30 01:49:28 INFO ShuffleBlockFetcherIterator: Getting 1 (3.5 KiB) non-empty blocks including 1 (3.5 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
23/07/30 01:49:28 INFO ShuffleBlockFetcherIterator: Getting 1 (3.9 KiB) non-empty blocks including 1 (3.9 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
23/07/30 01:49:28 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
23/07/30 01:49:28 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
23/07/30 01:49:28 INFO BlockManagerInfo: Removed broadcast_6_piece0 on 172.20.232.170:34743 in memory (size: 21.0 KiB, free: 2004.2 MiB)
23/07/30 01:49:28 INFO BlockManagerInfo: Removed broadcast_18_piece0 on 172.20.232.170:34743 in memory (size: 12.5 KiB, free: 2004.2 MiB)
23/07/30 01:49:28 INFO BlockManagerInfo: Removed broadcast_16_piece0 on 172.20.232.170:34743 in memory (size: 11.4 KiB, free: 2004.2 MiB)
23/07/30 01:49:28 INFO BlockManagerInfo: Removed broadcast_19_piece0 on 172.20.232.170:34743 in memory (size: 14.5 KiB, free: 2004.2 MiB)
23/07/30 01:49:28 INFO BlockManagerInfo: Removed broadcast_14_piece0 on 172.20.232.170:34743 in memory (size: 37.1 KiB, free: 2004.3 MiB)
23/07/30 01:49:28 INFO BlockManagerInfo: Removed broadcast_13_piece0 on 172.20.232.170:34743 in memory (size: 14.7 KiB, free: 2004.3 MiB)
23/07/30 01:49:28 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 172.20.232.170:34743 in memory (size: 63.4 KiB, free: 2004.3 MiB)
23/07/30 01:49:28 INFO BlockManagerInfo: Removed broadcast_10_piece0 on 172.20.232.170:34743 in memory (size: 42.1 KiB, free: 2004.4 MiB)
23/07/30 01:49:28 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.20.232.170:34743 in memory (size: 19.2 KiB, free: 2004.4 MiB)
23/07/30 01:49:28 INFO Executor: Finished task 1.0 in stage 20.0 (TID 22). 6033 bytes result sent to driver
23/07/30 01:49:28 INFO TaskSetManager: Finished task 1.0 in stage 20.0 (TID 22) in 193 ms on 172.20.232.170 (executor driver) (1/2)
23/07/30 01:49:28 INFO Executor: Finished task 0.0 in stage 20.0 (TID 21). 6386 bytes result sent to driver
23/07/30 01:49:28 INFO TaskSetManager: Finished task 0.0 in stage 20.0 (TID 21) in 195 ms on 172.20.232.170 (executor driver) (2/2)
23/07/30 01:49:28 INFO TaskSchedulerImpl: Removed TaskSet 20.0, whose tasks have all completed, from pool 
23/07/30 01:49:28 INFO DAGScheduler: ResultStage 20 (showString at NativeMethodAccessorImpl.java:0) finished in 0.199 s
23/07/30 01:49:28 INFO DAGScheduler: Job 14 is finished. Cancelling potential speculative or zombie tasks for this job
23/07/30 01:49:28 INFO TaskSchedulerImpl: Killing all running tasks in stage 20: Stage finished
23/07/30 01:49:28 INFO DAGScheduler: Job 14 finished: showString at NativeMethodAccessorImpl.java:0, took 0.200147 s
+--------------------+--------------------+--------------------+
|       cod_chav_patc|       cod_orde_tran|            metricas|
+--------------------+--------------------+--------------------+
|7ed61f4e-e875-476...|cliente_estabelec...|{{{{2023-07-20T13...|
|920c904e-4063-452...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|438dc8b1-9719-44f...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|b931a26d-726e-401...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|7ed61f4e-e875-476...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|7e240205-bb00-420...|cliente_estabelec...|{{{{2023-07-24T05...|
|3e332f35-086c-476...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|c82a6c15-d733-466...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|dc7972f0-1338-44b...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|9830349d-d9ef-4b4...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|da98da57-166a-4fc...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|2743e0df-5e15-428...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|ac98a368-dfc8-487...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|a22fc818-26f3-424...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|c1da8d39-f735-462...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|4fe4b735-5c29-46d...|cliente_estabelec...|{{{{2023-07-23T11...|
|312a4c3c-7f00-425...|cliente_estabelec...|{{{{2023-07-21T10...|
|4cc672fc-3006-4f8...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|b9534807-3009-41c...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
|35e1392e-8a74-4ec...|cliente_estabelec...|{{{{0, 0, 0, 0, 0...|
+--------------------+--------------------+--------------------+
only showing top 20 rows

23/07/30 01:49:28 INFO SparkContext: Invoking stop() from shutdown hook
23/07/30 01:49:28 INFO SparkUI: Stopped Spark web UI at http://172.20.232.170:4040
23/07/30 01:49:28 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
23/07/30 01:49:28 INFO MemoryStore: MemoryStore cleared
23/07/30 01:49:28 INFO BlockManager: BlockManager stopped
23/07/30 01:49:28 INFO BlockManagerMaster: BlockManagerMaster stopped
23/07/30 01:49:28 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
23/07/30 01:49:28 INFO SparkContext: Successfully stopped SparkContext
23/07/30 01:49:28 INFO ShutdownHookManager: Shutdown hook called
23/07/30 01:49:28 INFO ShutdownHookManager: Deleting directory /tmp/spark-7b112f2d-bd20-4013-a00a-2a15b1edfda3/pyspark-d9454af1-6dbb-4cb9-b630-0a23697289be
23/07/30 01:49:28 INFO ShutdownHookManager: Deleting directory /tmp/spark-92aa2ded-ee12-4fa6-84cc-293739eb3607
23/07/30 01:49:28 INFO ShutdownHookManager: Deleting directory /tmp/spark-7b112f2d-bd20-4013-a00a-2a15b1edfda3
